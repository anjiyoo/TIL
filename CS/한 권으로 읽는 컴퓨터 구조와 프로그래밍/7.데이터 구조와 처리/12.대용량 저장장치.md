디스크 드라이브 데이터 구성의 특이한 점을 이해해보자.

### 디스크 드라이브에 데이터 구성
디스크의 기본 단위는 `블록 block`이고 연속적인 블록을 `클러스터 cluster`라고 부른다. 클러스트는 한 트랙 안에 있는 연속적인 섹터로 이뤄짐으로, 데이터를 한 클라스터에만 저장할 수 있다면 좋을 것이다.

아주 높은 성능이 필요한 경우 이런 식으로 데이터를 저장하는 경우도 있지만 바람직한 방법은 아니다. (단, 데이터는 사용 가능한 섹터가 있으면 위치와 관계없이 저장된다) 대신 운영체제의 장치 드라이버가 데이터가 연속적으로 저장된 것 같은 착각을 불러일으킨다.

```
어떤 데이터를 저장하기 위한 저장소 블록을 여럿 확보해서 데이터를 이런 블록에 나눠 담아야 한다.
```

<br>

### 장기적인 데이터 저장 방법
데이터를 메모리 상에서 관리할 때는 포인터를 통해 메모리를 참조하는 것으로 충분하다. 하지만 메모리에 있는 정보는 일시적이고 데이터를 장기적으로 저장할 때는 디스크를 사용하므로 데이터를 디스크에 저장하기 위해서는 영구적인 어떤 존재가 필요하다.

> 파일 이름

`파일 이름`을 디스크에 저장할 방법과 파일 이름과 파일의 데이터가 저장된 디스크 블록을 연결해줄 방법이 필요하다. 이 모두를 처리할 방법이 블록 중 일부를 아이노드 inode(인덱스+노드)로 따로 지정한다. 

> 아이노드

`아이노드`에는 파일에 대한 여러 가지 정보가 들어간다. 이런 정보에는 파일 이름, 파일 소유자, 파일 크기, 파일에 대한 허가 내역 등이 포함된다. 아이노드에는 보통 `직접 블록 포인터(블록의 인덱스)`가 12개 있다. 따라서, 직접 블록을 통해 최대 49,152바이트까지 데이터를 보관할 수 있다(대부분의 파일은 이 정도로 충분하다). 파일이 더 커지면 `간접 블록`을 사용하기 시작한다. 간접 블록을 통해서는 최대 4MiB까지 지원할 수 있다. 이보다 더 큰 파일을 저장해야 하면 `2중 간접 블록`을 통해 4GiB까지, `3중 간접 블록`을 통해 4PiB까지 지원할 수 있다.

> 계층적 파일 시스템

아이노드 정보 중에는 블록에 데이터가 있는지 디렉터리 directory 정보가 있는지를 표시하는 것도 있다. 디렉터리는 파일 이름과 파일 데이터를 가리키는 아이노드를 연결해준다. 디렉터리는 다른 디렉터리를 참조할 수 있고 이로인해 트리 구조의 `계층적 파일 시스템`이 생겨났다.

> 심볼릭 링크

`계층적 파일 시스템`에서 여러 아이노드가 같은 블록을 참조할 수 있는데 이 참조를 `링크`라고 한다. 링크로 인해 같은 파일이 여러 디렉터리에 나타날 수 있다. 디렉터리에 대해 링크를 할 수 있으면 편리하단 근거로 `심볼릭 링크`가 발명됐다. 하지만 심볼릭 링크를 허용하면 파일 시스템 그래프에 루프가 생긴다. 이 무한 루프를 감지하기 위한 특별한 코드가 필요하다.

> 가용 공간 추적하는 방법

각 블록을 1비트로 표현하는 `비트맵`을 사용한 방식을 들 수 있다. 이 방법을 쓰면 비트맵이 아주 커질 수 있는데 8TB 디스크 드라이브를 다루기 위해서는 20억 비트가 필요한데, 이는 거의 256MiB의 공간이다.

비트맵을 사용하면 간단하면서 효율적이다. 가용 블록을 찾기 위해 모든 비트가 1이 아닌 워드를 쉽게 찾을 수 있다. 하지만 이 방법에는 파일 시스템 그래프와 가용 공간을 나타내는 비트맵 사이에 동기화가 깨질 수 있다는 문제가 있다. 예를 들어, 디스크에 데이터를 기록하는 도중에 전원이 나갈 수 있다.

이제는 오류를 더 효율적으로 수정할 수 있도록 설계된 `저널링`파일 시스템이 만들어져 널리 쓰이고 있다.